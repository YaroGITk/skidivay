{"t":{"$date":"2025-11-15T12:29:44.140Z"},"s":"E","c":"MONGOSH","id":1000000006,"ctx":"telemetry","msg":"Error: Failed to resolve machine ID","attr":{"stack":"Error: Failed to resolve machine ID\n    at i (eval at module.exports (node:lib-boxednode/mongosh:103:20), <anonymous>:341:193848)\n    at async LoggingAndTelemetry.setupTelemetry (eval at module.exports (node:lib-boxednode/mongosh:103:20), <anonymous>:341:302397)","name":"Error","message":"Failed to resolve machine ID","code":null}}
{"t":{"$date":"2025-11-15T12:29:44.206Z"},"s":"I","c":"MONGOSH","id":1000000005,"ctx":"config","msg":"User updated"}
{"t":{"$date":"2025-11-15T12:29:44.207Z"},"s":"I","c":"MONGOSH","id":1000000048,"ctx":"config","msg":"Loading global configuration file","attr":{"filename":"/etc/mongosh.conf","found":false}}
{"t":{"$date":"2025-11-15T12:29:44.207Z"},"s":"I","c":"MONGOSH","id":1000000000,"ctx":"log","msg":"Starting log","attr":{"execPath":"/usr/bin/mongosh","envInfo":{"EDITOR":null,"NODE_OPTIONS":null,"TERM":null},"installationMethod":"linux-system-wide","version":"2.5.9","distributionKind":"compiled","buildArch":"x64","buildPlatform":"linux","buildTarget":"linux-x64","buildTime":"2025-10-29T17:07:55.258Z","gitVersion":"f48698c7446594d355e043f608570da5f2c68891","nodeVersion":"v20.19.5","opensslVersion":"3.0.16","sharedOpenssl":false,"runtimeArch":"x64","runtimePlatform":"linux","runtimeGlibcVersion":"2.39","deps":{"nodeDriverVersion":"6.19.0","libmongocryptVersion":"1.15.1","libmongocryptNodeBindingsVersion":"6.5.0","kerberosVersion":"2.1.0"}}}
{"t":{"$date":"2025-11-15T12:29:44.341Z"},"s":"I","c":"DEVTOOLS-CONNECT","id":1000000049,"ctx":"mongosh-connect","msg":"Loaded system CA list","attr":{"caCount":296,"asyncFallbackError":null,"systemCertsError":null,"messages":[]}}
{"t":{"$date":"2025-11-15T12:29:44.379Z"},"s":"I","c":"DEVTOOLS-CONNECT","id":1000000042,"ctx":"mongosh-connect","msg":"Initiating connection attempt","attr":{"uri":"mongodb://127.0.0.1:27017/payapp?directConnection=true&serverSelectionTimeoutMS=2000&appName=mongosh+2.5.9","driver":{"name":"nodejs|mongosh","version":"6.19.0|2.5.9"},"devtoolsConnectVersion":"3.9.4","host":"127.0.0.1:27017"}}
{"t":{"$date":"2025-11-15T12:29:44.451Z"},"s":"I","c":"DEVTOOLS-CONNECT","id":1000000035,"ctx":"mongosh-connect","msg":"Server heartbeat succeeded","attr":{"connectionId":"127.0.0.1:27017"}}
{"t":{"$date":"2025-11-15T12:29:44.462Z"},"s":"I","c":"DEVTOOLS-CONNECT","id":1000000037,"ctx":"mongosh-connect","msg":"Connection attempt finished"}
{"t":{"$date":"2025-11-15T12:29:44.468Z"},"s":"I","c":"MONGOSH","id":1000000010,"ctx":"shell-api","msg":"Initialized context","attr":{"method":"setCtx","arguments":{}}}
{"t":{"$date":"2025-11-15T12:29:44.483Z"},"s":"I","c":"MONGOSH-SNIPPETS","id":1000000019,"ctx":"snippets","msg":"Loaded snippets","attr":{"installdir":"/data/db/.mongodb/mongosh/snippets"}}
{"t":{"$date":"2025-11-15T12:29:44.486Z"},"s":"I","c":"MONGOSH","id":1000000003,"ctx":"repl","msg":"Start loading CLI scripts"}
{"t":{"$date":"2025-11-15T12:29:44.810Z"},"s":"I","c":"MONGOSH","id":1000000012,"ctx":"shell-api","msg":"Loading file via load()","attr":{"nested":false,"filename":"/docker-entrypoint-initdb.d/mongo-init.js"}}
{"t":{"$date":"2025-11-15T12:29:44.820Z"},"s":"I","c":"MONGOSH","id":1000000007,"ctx":"repl","msg":"Evaluating input","attr":{"input":"db = db.getSiblingDB('payapp');\n\n// USERS\ndb.createCollection('users', {\n  validator: {\n    $jsonSchema: {\n      bsonType: \"object\",\n      required: [\"_id\",\"plan\",\"registeredAt\"],\n      properties: {\n        _id: { bsonType: \"string\", description: \"tg_id\" },\n        tgUsername: { bsonType: [\"string\",\"null\"], maxLength: 49 },\n        tgFirstName: { bsonType: [\"string\",\"null\"], maxLength: 255 },\n        tgLastName: { bsonType: [\"string\",\"null\"], maxLength: 255 },\n        plan: { enum: [\"free\",\"prem\"] },\n        tgPfp: { bsonType: [\"string\",\"null\"] },\n        tgPfpId: { bsonType: [\"string\",\"null\"], maxLength: 128 },\n        registeredAt: { bsonType: \"date\" }\n      }\n    }\n  }\n});\ndb.users.createIndex({ tgUsername: 1 }, { unique: true, sparse: true });\n\n// SAVED_DETAILS\ndb.createCollection('saved_details', {\n  validator: {\n    $jsonSchema: {\n      bsonType: \"object\",\n      required: [\"tgId\",\"type\",\"details\",\"createdAt\",\"updatedAt\"],\n      properties: {\n        tgId: { bsonType: \"string\" },\n        type: { enum: [\"bank\",\"sbp\",\"wallet\",\"crypto\"] },\n        details: { bsonType: \"object\" },\n        createdAt: { bsonType: \"date\" },\n        updatedAt: { bsonType: \"date\" }\n      }\n    }\n  }\n});\ndb.saved_details.createIndex({ tgId:1, type:1 });\n\n// INVOICES\ndb.createCollection('invoices', {\n  validator: {\n    $jsonSchema: {\n      bsonType: \"object\",\n      required: [\"_id\",\"ownerId\",\"type\",\"status\",\"sum\",\"receiversQuantity\",\"createdAt\"],\n      properties: {\n        _id: { bsonType: \"string\", description: \"UUID\" },\n        ownerId: { bsonType: \"string\" },\n        type: { enum: [\"solo\",\"multi\"] },\n        status: { enum: [\"verified\",\"pending\",\"waiting\"] },\n        sum: { bsonType: \"decimal\" },\n        receiversQuantity: { bsonType: \"int\", minimum: 1 },\n        description: { bsonType: [\"string\",\"null\"], maxLength: 255 },\n        deadline: { bsonType: [\"date\",\"null\"] },\n        banks: { bsonType: [\"object\",\"null\"] },\n        sbp: { bsonType: [\"object\",\"null\"] },\n        wallets: { bsonType: [\"object\",\"null\"] },\n        crypto: { bsonType: [\"object\",\"null\"] },\n        link: { bsonType: [\"string\",\"null\"] },\n        createdAt: { bsonType: \"date\" },\n        paidAt: { bsonType: [\"date\",\"null\"] },\n        paidBy: { bsonType: [\"string\",\"null\"] }\n      }\n    }\n  }\n});\ndb.invoices.createIndex({ ownerId:1, status:1 });\n\n// INVOICE_RECEIVERS\ndb.createCollection('invoice_receivers', {\n  validator: {\n    $jsonSchema: {\n      bsonType: \"object\",\n      required: [\"invoiceId\",\"receiverId\",\"accepted\",\"joinedAt\"],\n      properties: {\n        invoiceId: { bsonType: \"string\" },\n        receiverId: { bsonType: \"string\" },\n        accepted: { bsonType: \"bool\" },\n        joinedAt: { bsonType: \"date\" }\n      }\n    }\n  }\n});\ndb.invoice_receivers.createIndex({ invoiceId:1, receiverId:1 }, { unique: true });\n\n// PYRO_SESSIONS\ndb.createCollection('pyro_sessions', {\n  validator: {\n    $jsonSchema: {\n      bsonType: \"object\",\n      required: [\"name\",\"status\",\"isAlive\"],\n      properties: {\n        name: { bsonType: \"string\", maxLength: 50 },\n        status: { enum: [\"idle\",\"busy\",\"error\"] },\n        lastUsed: { bsonType: [\"date\",\"null\"] },\n        requestCount: { bsonType: [\"long\",\"int\",\"null\"], minimum: 0 },\n        lastError: { bsonType: [\"string\",\"null\"] },\n        isAlive: { bsonType: \"bool\" }\n      }\n    }\n  }\n});\ndb.pyro_sessions.createIndex({ name:1 }, { unique: true });\ndb.pyro_sessions.createIndex({ status:1 });\n\n// HUNTED_BASE\ndb.createCollection('hunted_base', {\n  validator: {\n    $jsonSchema: {\n      bsonType: \"object\",\n      required: [\"_id\",\"addedAt\"],\n      properties: {\n        _id: { bsonType: \"string\" },\n        tgUsername: { bsonType: [\"string\",\"null\"], maxLength: 49 },\n        tgFirstName: { bsonType: [\"string\",\"null\"], maxLength: 255 },\n        tgLastName: { bsonType: [\"string\",\"null\"], maxLength: 255 },\n        tgPfp: { bsonType: [\"string\",\"null\"] },\n        tgPfpId: { bsonType: [\"string\",\"null\"], maxLength: 128 },\n        addedAt: { bsonType: \"date\" }\n      }\n    }\n  }\n});\ndb.hunted_base.createIndex({ tgUsername:1 }, { unique: true, sparse: true });\n\n// USER_ACTIVITY\ndb.createCollection('user_activity', {\n  validator: {\n    $jsonSchema: {\n      bsonType: \"object\",\n      required: [\"tgId\",\"activityTime\"],\n      properties: {\n        tgId: { bsonType: \"string\" },\n        activityType: { bsonType: [\"string\",\"null\"], maxLength: 50 },\n        activityTime: { bsonType: \"date\" },\n        metadata: { bsonType: [\"object\",\"null\"] }\n      }\n    }\n  }\n});\ndb.user_activity.createIndex({ tgId:1, activityTime:-1 });"}}
{"t":{"$date":"2025-11-15T12:29:44.821Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"getSiblingDB","class":"Database","db":"payapp","arguments":{"db":"payapp"}}}
{"t":{"$date":"2025-11-15T12:29:44.822Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createCollection","class":"Database","db":"payapp","arguments":{"name":"users","options":{"validator":{"$jsonSchema":{"bsonType":"object","required":["_id","plan","registeredAt"],"properties":{"_id":{"bsonType":"string","description":"tg_id"},"tgUsername":{"bsonType":["string","null"],"maxLength":49},"tgFirstName":{"bsonType":["string","null"],"maxLength":255},"tgLastName":{"bsonType":["string","null"],"maxLength":255},"plan":{"enum":["free","prem"]},"tgPfp":{"bsonType":["string","null"]},"tgPfpId":{"bsonType":["string","null"],"maxLength":128},"registeredAt":{"bsonType":"date"}}}}}}}}
{"t":{"$date":"2025-11-15T12:29:44.824Z"},"s":"I","c":"MONGOSH","id":1000000004,"ctx":"connect","msg":"Connecting to server","attr":{"userId":null,"telemetryAnonymousId":"691872361d432490f49dc29b","connectionUri":"mongodb://<ip address>:27017/payapp?directConnection=true&serverSelectionTimeoutMS=2000&appName=mongosh+2.5.9","is_localhost":true,"is_do_url":false,"is_atlas_url":false,"is_atlas":false,"server_version":"8.2.1","node_version":"v20.19.5","server_os":"linux","server_arch":"x86_64","is_enterprise":false,"auth_type":null,"is_data_federation":false,"is_stream":false,"dl_version":null,"atlas_version":null,"is_genuine":true,"non_genuine_server_name":"mongodb","is_local_atlas":false,"fcv":"8.2","api_version":null,"api_strict":null,"api_deprecation_errors":null,"atlas_hostname":null}}
{"t":{"$date":"2025-11-15T12:29:44.850Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createIndex","class":"Collection","db":"payapp","coll":"users","arguments":{"keys":{"tgUsername":1},"options":{"unique":true,"sparse":true}}}}
{"t":{"$date":"2025-11-15T12:29:44.887Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createCollection","class":"Database","db":"payapp","arguments":{"name":"saved_details","options":{"validator":{"$jsonSchema":{"bsonType":"object","required":["tgId","type","details","createdAt","updatedAt"],"properties":{"tgId":{"bsonType":"string"},"type":{"enum":["bank","sbp","wallet","crypto"]},"details":{"bsonType":"object"},"createdAt":{"bsonType":"date"},"updatedAt":{"bsonType":"date"}}}}}}}}
{"t":{"$date":"2025-11-15T12:29:44.944Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createIndex","class":"Collection","db":"payapp","coll":"saved_details","arguments":{"keys":{"tgId":1,"type":1},"options":{}}}}
{"t":{"$date":"2025-11-15T12:29:44.970Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createCollection","class":"Database","db":"payapp","arguments":{"name":"invoices","options":{"validator":{"$jsonSchema":{"bsonType":"object","required":["_id","ownerId","type","status","sum","receiversQuantity","createdAt"],"properties":{"_id":{"bsonType":"string","description":"UUID"},"ownerId":{"bsonType":"string"},"type":{"enum":["solo","multi"]},"status":{"enum":["verified","pending","waiting"]},"sum":{"bsonType":"decimal"},"receiversQuantity":{"bsonType":"int","minimum":1},"description":{"bsonType":["string","null"],"maxLength":255},"deadline":{"bsonType":["date","null"]},"banks":{"bsonType":["object","null"]},"sbp":{"bsonType":["object","null"]},"wallets":{"bsonType":["object","null"]},"crypto":{"bsonType":["object","null"]},"link":{"bsonType":["string","null"]},"createdAt":{"bsonType":"date"},"paidAt":{"bsonType":["date","null"]},"paidBy":{"bsonType":["string","null"]}}}}}}}}
{"t":{"$date":"2025-11-15T12:29:45.015Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createIndex","class":"Collection","db":"payapp","coll":"invoices","arguments":{"keys":{"ownerId":1,"status":1},"options":{}}}}
{"t":{"$date":"2025-11-15T12:29:45.041Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createCollection","class":"Database","db":"payapp","arguments":{"name":"invoice_receivers","options":{"validator":{"$jsonSchema":{"bsonType":"object","required":["invoiceId","receiverId","accepted","joinedAt"],"properties":{"invoiceId":{"bsonType":"string"},"receiverId":{"bsonType":"string"},"accepted":{"bsonType":"bool"},"joinedAt":{"bsonType":"date"}}}}}}}}
{"t":{"$date":"2025-11-15T12:29:45.084Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createIndex","class":"Collection","db":"payapp","coll":"invoice_receivers","arguments":{"keys":{"invoiceId":1,"receiverId":1},"options":{"unique":true}}}}
{"t":{"$date":"2025-11-15T12:29:45.115Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createCollection","class":"Database","db":"payapp","arguments":{"name":"pyro_sessions","options":{"validator":{"$jsonSchema":{"bsonType":"object","required":["name","status","isAlive"],"properties":{"name":{"bsonType":"string","maxLength":50},"status":{"enum":["idle","busy","error"]},"lastUsed":{"bsonType":["date","null"]},"requestCount":{"bsonType":["long","int","null"],"minimum":0},"lastError":{"bsonType":["string","null"]},"isAlive":{"bsonType":"bool"}}}}}}}}
{"t":{"$date":"2025-11-15T12:29:45.160Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createIndex","class":"Collection","db":"payapp","coll":"pyro_sessions","arguments":{"keys":{"name":1},"options":{"unique":true}}}}
{"t":{"$date":"2025-11-15T12:29:45.184Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createIndex","class":"Collection","db":"payapp","coll":"pyro_sessions","arguments":{"keys":{"status":1},"options":{}}}}
{"t":{"$date":"2025-11-15T12:29:45.219Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createCollection","class":"Database","db":"payapp","arguments":{"name":"hunted_base","options":{"validator":{"$jsonSchema":{"bsonType":"object","required":["_id","addedAt"],"properties":{"_id":{"bsonType":"string"},"tgUsername":{"bsonType":["string","null"],"maxLength":49},"tgFirstName":{"bsonType":["string","null"],"maxLength":255},"tgLastName":{"bsonType":["string","null"],"maxLength":255},"tgPfp":{"bsonType":["string","null"]},"tgPfpId":{"bsonType":["string","null"],"maxLength":128},"addedAt":{"bsonType":"date"}}}}}}}}
{"t":{"$date":"2025-11-15T12:29:45.274Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createIndex","class":"Collection","db":"payapp","coll":"hunted_base","arguments":{"keys":{"tgUsername":1},"options":{"unique":true,"sparse":true}}}}
{"t":{"$date":"2025-11-15T12:29:45.303Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createCollection","class":"Database","db":"payapp","arguments":{"name":"user_activity","options":{"validator":{"$jsonSchema":{"bsonType":"object","required":["tgId","activityTime"],"properties":{"tgId":{"bsonType":"string"},"activityType":{"bsonType":["string","null"],"maxLength":50},"activityTime":{"bsonType":"date"},"metadata":{"bsonType":["object","null"]}}}}}}}}
{"t":{"$date":"2025-11-15T12:29:45.343Z"},"s":"I","c":"MONGOSH","id":1000000011,"ctx":"shell-api","msg":"Performed API call","attr":{"method":"createIndex","class":"Collection","db":"payapp","coll":"user_activity","arguments":{"keys":{"tgId":1,"activityTime":-1},"options":{}}}}
{"t":{"$date":"2025-11-15T12:29:45.375Z"},"s":"I","c":"MONGOSH","id":1000000045,"ctx":"analytics","msg":"Flushed outstanding data","attr":{"flushError":"Trying to persist throttle state before userId is set","flushDuration":1}}
